<ngx-base-form [title]="title" [routes]="routes" [messageError]="messageError" [routeBack]="routeBack"
               [actionSave]="Save.bind(this)"
                [showActionsHeaders]="false">
  <div content>
    <form class="container" [formGroup]="form" (ngSubmit)="Save()">
      <div class="row">
        <div class="col-md-4">
          <div class="form-group">
            <label for="survey_type_id" class="form-text text-muted font-weight-bold">
              Tipo plantilla:
            </label>
            <nb-select formControlName="survey_type_id" id="survey_type_id" fullWidth
                       status="{{ isSubmitted && form.controls.survey_type_id.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
              <nb-option value="">Seleccione...</nb-option>
              <nb-option *ngFor="let item of surveyTypes" [value]="item.id">{{ item.name }}</nb-option>
            </nb-select>
          </div>
        </div>

        <div class="col-md-6">
          <div class="form-group">
            <label for="name" class="form-text text-muted font-weight-bold">
              Nombre:
            </label>
            <input nbInput fullWidth id="name" formControlName="name" name
                   status="{{ isSubmitted && form.controls.name.errors ? 'danger' : isSubmitted ? 'success' : '' }}"/>
          </div>
        </div>

        <div class="col-md-2">
          <div class="form-group">
            <label for="duration_h" class="form-text text-muted font-weight-bold">
              Duración:
            </label>
            <div class="row">

              <div class="col-md-6 pr-1">
                <input placeholder="HH" min="0" max="10" type="number" nbInput fullWidth id="duration_h"
                       formControlName="duration_h" duration_h
                       status="{{ isSubmitted && form.controls.duration_h.errors ? 'danger' : isSubmitted ? 'success' : '' }}"
                />
              </div>
              <div class="col-md-6 pl-1">
                <input placeholder="MM" min="0" max="60" type="number" nbInput fullWidth id="duration_m"
                       formControlName="duration_m" duration_m
                       status="{{ isSubmitted && form.controls.duration_m.errors ? 'danger' : isSubmitted ? 'success' : '' }}"
                />
              </div>
            </div>
            <ng-container *ngIf="form.controls.duration_m.errors && form.controls.duration_m.touched">
              <p class="caption status-danger"
                 *ngIf="form.controls.duration_m.errors?.min || form.controls.duration_m.errors?.max">
                Los minutos deben estar entre 0 y 60
              </p>
            </ng-container>

            <ng-container *ngIf="form.controls.duration_h.errors && form.controls.duration_h.touched">
              <p class="caption status-danger"
                 *ngIf="form.controls.duration_h.errors?.min || form.controls.duration_h.errors?.max">
                Las horas deben estar entre 0 y 10
              </p>
            </ng-container>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12">
          <div class="form-group">
            <label for="description" class="form-text text-muted font-weight-bold">
              Descripción:
            </label>
            <textarea nbInput fullWidth id="description" formControlName="description" description
                      status="{{ isSubmitted && form.controls.description.errors ? 'danger' : isSubmitted ? 'success' : '' }}"
                      rows="4"
            ></textarea>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12">
          <div class="form-group">
            <label for="url_image" class="form-text text-muted font-weight-bold">
              Imagen de encabezado:
            </label>
            <ng-container *ngIf="form.controls.url_image.errors && form.controls.url_image.touched">
              <p class="caption status-danger" *ngIf="form.controls.url_image.errors?.required">
                La imagen de encabezado es requerida
              </p>
            </ng-container>
            <div *ngIf="previewImage" class="container py-2">
              <img class="img-fluid" [src]="previewImage" alt="">
            </div>
            <button nbButton type="button" status="danger" (click)="uploadImage()">Subir imagen
            </button>
            <input style="display: none" accept="image/*" type="file" id="url_image" nbInput fullWidth
                   (change)="changeImage($event.target.files)"
            />
          </div>
        </div>
      </div>

    </form>
  </div>

  <div end>
    <ngx-sections-surveys *ngIf="data" [survey_id]="data.id">

    </ngx-sections-surveys>
  </div>
</ngx-base-form>
