<form [formGroup]="form" (ngSubmit)="save()">

  <div>
    <fieldset class="field_set center">
      <legend class="prue1  center ">SALIDA DEL PACIENTE</legend>
      <div class="row justify-content-md-center">
        <div class="col col-lg-2">
          <label class="form-text text-muted font-weight-bold">Estado de Salida</label>
        </div>
        <div class="col col-lg-2">
          <nb-radio-group formControlName="exit_status" exit_status id="exit_status" class="d-flex text center"
            name="exit_status"
            status="{{ isSubmitted && form.controls.exit_status.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
            <nb-radio value="1">Vivo</nb-radio>
            <nb-radio value="2">Fallecido</nb-radio>
          </nb-radio-group>
        </div>
      </div>

      <div class="col col-lg-12">
        <hr />
      </div>

      <!-- <div class="container">
        <div class="row justify-content-md-center">
          <div class="col col-lg-12">
            <hr />
          </div>
        </div>
      </div> -->
      <div *ngIf="this.form.controls.exit_status.value=='2'">
        <div class="row justify-content-md-center">
          <div class="col col-lg-3">
            <label class="form-text text-muted font-weight-bold">Fecha y Hora de Muerte</label>
            <input type="datetime-local" id="date_time" formControlName="date_time">

          </div>

          <div class="col col-lg-3">
            <label class="form-text text-muted font-weight-bold">Traslado a Medicina Legal</label>
            <nb-radio-group formControlName="legal_medicine_transfer" legal_medicine_transfer
              id="legal_medicine_transfer" class="d-flex text center" name="legal_medicine_transfer"
              status="{{ isSubmitted && form.controls.legal_medicine_transfer.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
              <nb-radio value="1">Si</nb-radio>
            </nb-radio-group>
          </div>
        </div>

        <div class="col col-lg-12">
          <hr />
        </div>

        <div class="row justify-content-md-center">

          
          <div class="col-md-3">
            <label for="death_diagnosis_id" class="form-text text-muted font-weight-bold ">Causa de la Muerte</label>
            <input disabled="{{ isSubmitted }}" placeholder="SELECCIONE UN DIAGNOSTICO" fullWidth nbInput list="codes"
              (change)="saveCode($event.target.value)" id="death_diagnosis_id" formControlName="death_diagnosis_id"
              death_diagnosis_id type="text" required
              status="{{ isSubmitted && form.controls.death_diagnosis_id.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
            <datalist id="codes">
              <option *ngFor="let item of diagnosis" [value]="item.name">{{ item.code }} - {{item.name}}
              </option>
            </datalist>
          </div>





          <!-- <div class="col col-lg-3">
            <label class="form-text text-muted font-weight-bold">Causa de la Muerte:</label>
            <nb-select [selected]="this.data.death_diagnosis_id" formControlName="death_diagnosis_id"
              id="death_diagnosis_id"
              status="{{ isSubmitted && form.controls.death_diagnosis_id.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
              <nb-option value="">SELECCIONE...</nb-option>
              <nb-option selected="{{ item.id == this.data.death_diagnosis_id }}"
                *ngFor="let item of death_diagnosis_id" [value]="item.id">
                {{ item.name }}</nb-option>
            </nb-select>
          </div> -->
          <div class="col col-lg-3">
            <label class="form-text text-muted font-weight-bold">Medico que Firma Certificado de Defunción</label>
            <input type="text" class="Box" id="medical_signature" formControlName="medical_signature" required nbInput
              ngModel
              status="{{ isSubmitted && form.controls.medical_signature.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
          </div>
          <div class="col col-lg-4">
            <label class="form-text text-muted font-weight-bold">N° de Certificado de Defunción</label>
            <input type="number" class="Box" id="death_certificate_number" formControlName="death_certificate_number"
              required nbInput ngModel
              status="{{ isSubmitted && form.controls.death_certificate_number.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
          </div>
        </div>
      </div>


      <div *ngIf="this.form.controls.exit_status.value=='1'">
        <div class="row justify-content-md-center">
          <div class="col col-lg-3">


            <label for="ch_diagnosis_id" class="form-text text-muted font-weight-bold ">DX Ingreso:</label>
            <input disabled="{{ isSubmitted }}" placeholder="SELECCIONE UN DIAGNOSTICO" fullWidth nbInput list="codes2"
              id="ch_diagnosis_id" formControlName="ch_diagnosis_id" ch_diagnosis_id type="text" required
              status="{{ isSubmitted && form.controls.ch_diagnosis_id.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
            <datalist id="codes2">
              <option selected="{{ item.id == this.data.ch_diagnosis_id }}" *ngFor="let item of ch_diagnosis"
                [value]="item.name">
                {{ item.diagnosis_id }} - {{ item.diagnosis.name }}
              </option>
            </datalist>
          </div>

          <div class="col-md-4">
            <label for="exit_diagnosis_id" class="form-text text-muted font-weight-bold ">DX Salida</label>
            <input disabled="{{ isSubmitted }}" placeholder="SELECCIONE UN DIAGNOSTICO" fullWidth nbInput list="codes"
              (change)="saveCode($event.target.value,1)" id="exit_diagnosis_id" formControlName="exit_diagnosis_id"
              exit_diagnosis_id type="text" required
              status="{{ isSubmitted && form.controls.exit_diagnosis_id.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
            <datalist id="codes">
              <option *ngFor="let item of diagnosis" [value]="item.name">{{ item.code }} - {{item.name}}
              </option>
            </datalist>
          </div>

          <div class="col-md-4 ">
            <label for="relations_diagnosis_id" class="form-text text-muted font-weight-bold">DX Relacionado</label>
            <input disabled="{{ isSubmitted }}" placeholder="SELECCIONE UN DIAGNOSTICO" fullWidth nbInput list="codes"
              (change)="saveCode($event.target.value,2)" id="relations_diagnosis_id"
              formControlName="relations_diagnosis_id" relations_diagnosis_id type="text" required
              status="{{ isSubmitted && form.controls.relations_diagnosis_id.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
            <datalist id="codes">
              <option *ngFor="let item of relations_diagnosis" [value]="item.name">{{ item.code }} - {{item.name}}
              </option>
            </datalist>
          </div>

          <div class="col col-lg-3">
            <label class="form-text text-muted font-weight-bold">Motivo de salida:</label>
            <nb-select [selected]="this.data.reason_exit_id" formControlName="reason_exit_id" id="reason_exit_id"
              status="{{ isSubmitted && form.controls.reason_exit_id.errors ? 'danger' : isSubmitted ? 'success' : '' }}">
              <nb-option value="">SELECCIONE...</nb-option>
              <nb-option selected="{{ item.id == this.data.reason_exit_id }}" *ngFor="let item of reason_exit_id"
                [value]="item.id">
                {{ item.name }}</nb-option>
            </nb-select>
          </div>


        </div>
      </div>

    </fieldset>


    <div class="row">
      <div class="col-md-12">
        <button nbButton status="danger" class="ml-1 btn-save" [disabled]="disabled" type="button"
          (click)="save()">GUARDAR</button>
      </div>
    </div>

  </div>
</form>